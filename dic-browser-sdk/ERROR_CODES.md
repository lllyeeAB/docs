# DIC Browser SDK 错误码参考文档

## 📋 概述

本文档详细介绍了DIC Browser SDK使用的标准错误码体系。错误码范围为 **5000-5999**，按功能模块进行分类，每个错误都包含详细的描述、严重性级别和解决方案。

## 🔢 错误码结构

### 错误码范围分配

| 范围 | 分类 | 描述 |
|------|------|------|
| 5000-5099 | 通用错误 | 跨模块的通用错误类型 |
| 5100-5199 | 配置错误 | SDK配置相关错误 |
| 5200-5299 | 实例管理 | Chromium实例管理错误 |
| 5300-5399 | 进程操作 | 进程启动、终止相关错误 |
| 5400-5499 | 指纹处理 | 指纹生成、验证相关错误 |
| 5500-5599 | 网络连接 | 网络、端口相关错误 |
| 5600-5699 | 文件系统 | 文件、目录操作错误 |
| 5700-5799 | 加密解密 | 安全、加密相关错误 |
| 5800-5899 | 启动相关 | Chromium启动相关错误 |
| 5900-5999 | 内核相关 | 内核通信、兼容性错误 |

### 严重性级别

| 级别 | 描述 | 影响 |
|------|------|------|
| `low` | 低级别 | 警告性质，不影响主要功能 |
| `medium` | 中级别 | 部分功能受影响 |
| `high` | 高级别 | 主要功能无法使用 |
| `critical` | 严重级别 | 系统无法正常工作 |

## 📚 错误码详细说明

### 🔧 通用错误 (5000-5099)

#### 5000 - 未知错误
- **描述**: 发生了未预期的错误
- **严重性**: medium
- **解决方案**:
  - 检查输入参数
  - 重试操作
  - 联系技术支持

#### 5001 - 操作超时
- **描述**: 操作执行时间超过了预设的超时限制
- **严重性**: medium
- **解决方案**:
  - 增加超时时间
  - 检查网络连接
  - 检查系统负载

#### 5002 - 参数无效
- **描述**: 传入的参数不符合要求
- **严重性**: low
- **解决方案**:
  - 检查参数类型和取值范围
  - 参考API文档

#### 5003 - 操作被取消
- **描述**: 用户或系统取消了正在进行的操作
- **严重性**: low

#### 5004 - 权限不足
- **描述**: 当前用户没有执行此操作的权限
- **严重性**: high
- **解决方案**:
  - 以管理员身份运行
  - 检查文件权限
  - 联系系统管理员

### ⚙️ 配置错误 (5100-5199)

#### 5100 - SDK未初始化
- **描述**: 在使用SDK功能前必须先调用初始化方法
- **严重性**: high
- **解决方案**:
  - 调用 `sdk.initialize()` 方法

#### 5101 - 配置无效
- **描述**: 提供的配置参数无效
- **严重性**: high
- **解决方案**:
  - 检查配置参数
  - 参考配置文档
  - 使用默认配置

#### 5102 - 基础目录无效
- **描述**: 指定的基础目录路径无效或无权限访问
- **严重性**: high
- **解决方案**:
  - 检查目录路径
  - 确保目录存在
  - 检查读写权限

#### 5104 - 配置参数缺失
- **描述**: 缺少必要的配置参数
- **严重性**: high
- **解决方案**:
  - 补充缺失的配置参数
  - 使用完整的配置模板

#### 5105 - 配置值超出范围
- **描述**: 配置参数的值超出了允许的范围
- **严重性**: medium
- **解决方案**:
  - 调整配置值到有效范围内
  - 查看参数限制说明

### 🔄 实例管理错误 (5200-5299)

#### 5200 - 实例未找到
- **描述**: 指定的实例ID不存在
- **严重性**: medium
- **解决方案**:
  - 检查实例ID是否正确
  - 确认实例是否已被删除

#### 5201 - 实例已存在
- **描述**: 尝试创建的实例ID已经存在
- **严重性**: low
- **解决方案**:
  - 使用不同的实例ID
  - 或者连接到已存在的实例

#### 5202 - 实例状态无效
- **描述**: 实例当前状态不允许执行此操作
- **严重性**: medium
- **解决方案**:
  - 等待实例状态改变
  - 检查实例状态
  - 重启实例

#### 5203 - 实例正在运行
- **描述**: 实例已处于运行状态
- **严重性**: low
- **解决方案**:
  - 直接使用正在运行的实例
  - 或先关闭再重新启动

#### 5204 - 实例已关闭
- **描述**: 实例已被关闭，无法执行操作
- **严重性**: medium
- **解决方案**:
  - 重新启动实例
  - 创建新的实例

#### 5207 - 实例数量超限
- **描述**: 已达到最大实例数量限制
- **严重性**: medium
- **解决方案**:
  - 关闭不需要的实例
  - 增加实例数量限制
  - 使用实例池

### ⚡ 进程操作错误 (5300-5399)

#### 5300 - 进程未找到
- **描述**: 指定的进程不存在
- **严重性**: medium
- **解决方案**:
  - 检查进程ID
  - 确认进程是否已结束

#### 5301 - 进程启动失败
- **描述**: 无法启动指定的进程
- **严重性**: high
- **解决方案**:
  - 检查可执行文件路径
  - 确认文件权限
  - 检查系统资源

#### 5302 - 进程终止失败
- **描述**: 无法终止指定的进程
- **严重性**: medium
- **解决方案**:
  - 使用强制终止
  - 检查进程权限
  - 重启系统

#### 5304 - 进程崩溃
- **描述**: 进程意外崩溃
- **严重性**: high
- **解决方案**:
  - 重启进程
  - 检查系统日志
  - 更新软件版本

### 🔍 指纹处理错误 (5400-5499)

#### 5400 - 指纹配置无效
- **描述**: 指纹配置参数无效
- **严重性**: medium
- **解决方案**:
  - 检查指纹配置参数
  - 使用默认指纹配置
  - 参考指纹配置文档

#### 5401 - 指纹生成失败
- **描述**: 无法生成指纹
- **严重性**: high
- **解决方案**:
  - 重试生成操作
  - 检查配置参数
  - 使用备用指纹方案

#### 5404 - 指纹参数超出范围
- **描述**: 指纹参数值超出允许范围
- **严重性**: low
- **解决方案**:
  - 调整参数值到有效范围
  - 查看参数限制说明

### 🌐 网络相关错误 (5500-5599)

#### 5500 - 端口被占用
- **描述**: 指定的端口已被其他程序占用
- **严重性**: medium
- **解决方案**:
  - 使用其他端口
  - 关闭占用端口的程序
  - 自动分配端口

#### 5501 - 端口不可用
- **描述**: 指定端口范围内没有可用端口
- **严重性**: medium
- **解决方案**:
  - 扩大端口范围
  - 释放已占用端口
  - 重启网络服务

#### 5503 - 代理配置无效
- **描述**: 代理服务器配置无效
- **严重性**: medium
- **解决方案**:
  - 检查代理设置
  - 测试代理连接
  - 使用直接连接

### 📁 文件系统错误 (5600-5699)

#### 5600 - 文件未找到
- **描述**: 指定的文件不存在
- **严重性**: medium
- **解决方案**:
  - 检查文件路径
  - 确认文件是否存在
  - 重新安装相关文件

#### 5601 - 文件访问被拒绝
- **描述**: 没有访问文件的权限
- **严重性**: high
- **解决方案**:
  - 检查文件权限
  - 以管理员身份运行
  - 修改文件权限

#### 5602 - 目录创建失败
- **描述**: 无法创建指定目录
- **严重性**: high
- **解决方案**:
  - 检查父目录权限
  - 确保磁盘空间充足
  - 检查路径有效性

### 🔐 加密解密错误 (5700-5799)

#### 5700 - 加密失败
- **描述**: 数据加密操作失败
- **严重性**: high
- **解决方案**:
  - 检查加密密钥
  - 重试加密操作
  - 使用备用加密方法

#### 5701 - 解密失败
- **描述**: 数据解密操作失败
- **严重性**: high
- **解决方案**:
  - 检查解密密钥
  - 确认数据完整性
  - 重新获取加密数据

### 🚀 启动相关错误 (5800-5899)

#### 5800 - Chromium可执行文件未找到
- **描述**: 无法找到Chromium浏览器可执行文件
- **严重性**: critical
- **解决方案**:
  - 安装Chromium浏览器
  - 检查安装路径
  - 更新环境变量

#### 5801 - 启动参数无效
- **描述**: 提供的启动参数无效
- **严重性**: medium
- **解决方案**:
  - 检查启动参数格式
  - 移除无效参数
  - 参考参数文档

#### 5802 - 启动超时
- **描述**: 浏览器启动超时
- **严重性**: high
- **解决方案**:
  - 增加启动超时时间
  - 检查系统资源
  - 重启系统

#### 5805 - 启动权限不足
- **描述**: 没有启动浏览器的权限
- **严重性**: high
- **解决方案**:
  - 以管理员身份运行
  - 检查安全策略
  - 修改用户权限

### 🔧 内核相关错误 (5900-5999)

#### 5900 - 内核版本不兼容
- **描述**: 内核版本与SDK不兼容
- **严重性**: critical
- **解决方案**:
  - 更新内核版本
  - 使用兼容的SDK版本
  - 联系技术支持

#### 5901 - 内核初始化失败
- **描述**: 内核初始化过程失败
- **严重性**: critical
- **解决方案**:
  - 重启应用
  - 检查内核文件
  - 重新安装内核

## 💻 错误处理最佳实践

### 1. 错误捕获
```javascript
try {
  await sdk.launch(options);
} catch (error) {
  if (error instanceof DICError) {
    console.log(`错误码: ${error.code}`);
    console.log(`错误消息: ${error.message}`);
    console.log(`严重性: ${error.errorInfo.severity}`);
    console.log(`解决方案:`, error.errorInfo.solutions);
  }
}
```

### 2. 错误分类处理
```javascript
try {
  // 执行操作
} catch (error) {
  if (error instanceof DICError) {
    switch (error.code) {
      case DICErrorCode.NOT_INITIALIZED:
        // 初始化SDK
        await sdk.initialize(config);
        break;
      
      case DICErrorCode.PORT_ALREADY_IN_USE:
        // 使用其他端口
        options.debugPort = 0; // 自动分配
        break;
      
      case DICErrorCode.CHROMIUM_EXECUTABLE_NOT_FOUND:
        // 提示用户安装Chromium
        showInstallChromiumDialog();
        break;
      
      default:
        // 通用错误处理
        handleGenericError(error);
    }
  }
}
```

### 3. 错误重试机制
```javascript
import { ErrorUtils } from 'dic-browser-sdk';

async function retryableOperation(operation, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      return await operation();
    } catch (error) {
      if (error instanceof DICError && ErrorUtils.isRetryable(error)) {
        console.log(`重试第 ${i + 1} 次...`);
        await sleep(1000 * (i + 1)); // 延迟重试
        continue;
      }
      throw error; // 不可重试的错误直接抛出
    }
  }
  throw new Error('重试次数已达上限');
}
```

### 4. 错误日志记录
```javascript
function logError(error) {
  if (error instanceof DICError) {
    const errorInfo = error.getFullInfo();
    
    console.log({
      timestamp: new Date().toISOString(),
      errorCode: errorInfo.code,
      message: errorInfo.message,
      severity: errorInfo.severity,
      context: errorInfo.context,
      stack: error.stack
    });
  }
}
```

## 🔍 故障排除指南

### 常见错误组合

1. **启动失败**:
   - 5800 (Chromium可执行文件未找到) + 5601 (文件访问被拒绝)
   - **解决**: 安装Chromium并检查权限

2. **实例管理问题**:
   - 5200 (实例未找到) + 5304 (进程崩溃)
   - **解决**: 检查进程状态并重新启动

3. **网络配置问题**:
   - 5500 (端口被占用) + 5501 (端口不可用)
   - **解决**: 使用自动端口分配

### 调试模式
```javascript
// 启用详细错误信息
await sdk.initialize({
  baseDir: './data',
  logLevel: 'debug'
});

// 监听错误事件
sdk.on('error', (error) => {
  if (error instanceof DICError) {
    console.log('SDK错误:', error.getFullInfo());
  }
});
```

## 📞 技术支持

如果遇到本文档未涵盖的错误或问题，请提供以下信息：

1. 错误码和完整错误消息
2. 错误发生时的操作步骤
3. 系统环境信息
4. SDK版本号
5. 相关日志文件

通过提供详细的错误上下文，我们能够更快地为您提供解决方案。
